<!-- included similar tags as a extends from generic template -->
{% extends "generictemplate.html" %}
<!--This is for the icon display-->
{% block links %} <link rel="shortcut icon" href="{{ url_for('static', filename='icon.png') }}"> 
<link rel="stylesheet" href="{{url_for('static', filename='style.css')}}">
{% endblock %}
{% block title %}<title>Login Page</title>{% endblock %} 
{%  block styles %} 
<style>
    body {
        font-family: Arial;
        background-image: url('static/girlbook.gif'); background-size: cover; background-repeat: no-repeat;
        }

        * {
        box-sizing: border-box;
        }

        form.example input[type=text] {
        padding: 10px;
        font-size: 17px;
        border: 1px solid grey;
        float: left;
        width: 80%;
        background: #f1f1f1;
        }

        form.example button {
        float: left;
        width: 20%;
        padding: 10px;
        background: #2196F3;
        color: white;
        font-size: 17px;
        border: 1px solid grey;
        border-left: none;
        cursor: pointer;
        }

        form.example button:hover {
        background: #0b7dda;
        }

        .my-custom-scrollbar {
            position: relative;
            height: 400px;
            overflow: auto;
        }
        .table-wrapper-scroll-y {
        display: block;
        }
</style>

{% block scripts%}
<script type = "text/javascript"> 

function reviewapi(ele) {
    var email= document.getElementById("email").innerText
    // console.log(temp);
    var isbn = "1416949658";
    var xhr = new XMLHttpRequest();
    var form = new FormData(document.getElementById("reviewform"));
    var rating = form.get("rate");
    var comment=form.get("review")
    xhr.open("POST", "/api/submitReview?isbn="+isbn, true);
    xhr.setRequestHeader("Content-type", "application/json");
    let json = JSON.stringify ({
    "rate": rating,
    "review":comment,
    "email":email
  });
  xhr.send(json);
  xhr.onload = () => {
    if (xhr.status == 200) {
      var data = JSON.parse(xhr.responseText);
      console.log(data)
      document.getElementById("msg_display").innerHTML = "Review Submitted Successfully";
    } else  {
        var data = JSON.parse(xhr.responseText);
        console.log(data)
        document.getElementById("msg_display").innerHTML = "You have already reviewed the book";
    }

  }
}
    
</script>
{% endblock %}




    </script>
{% endblock %}   
{% block body %}
        <!--Navbar which displays user email and logout button-->
        <nav class="navbar navbar-dark bg-dark justify-content-between">
        <a class="navbar-brand text-primary" id="email"> {{ user }}</a>
        <form class="form-inline">
            <button class="btn btn-outline-primary my-2 my-sm-0" type="submit" formaction = '/logout'>Logout</button>
        </form>
        </nav>
        </br>
        </br>
        </br>
        <!--This is for search area with icon search-->
        <form id = "reviewform" method="POST" onsubmit="event.preventDefault();reviewapi(this)" >
            <div style = "padding-bottom: 18px; font-size:24px ;">Book Review</div>
            <!-- The rating is submitted from the user by pressing on these stars -->

            <div style="padding-bottom: 18px;">Rate this book<br/>
            </div>
            <div class="rate">
                <input type="radio" id="star5" name="rate" value="5" />
                <label for="star5" title="text">5</label>
                <input type="radio" id="star4" name="rate" value="4" />
                <label for="star4" title="text">4 </label>
                <input type="radio" id="star3" name="rate" value="3" />
                <label for="star3" title="text">3 </label>
                <input type="radio" id="star2" name="rate" value="2" />
                <label for="star2" title="text">2 </label>
                <input type="radio" id="star1" name="rate" value="1" />
                <label for="star1" title="text">1 </label>
            </div>
           <br></br>
        </br>
        <!-- The User can write the review here -->
            <div style="padding-bottom: 18px; align-content: flex-start;">Review<br/>
                <textarea  style="width : 500px;" rows="6" class="form-control" name="review" ></textarea>
            </div>
            <button class="btn btn-outline-primary my-2 my-sm-0" type="submit"  id="1416949658"  >Submit</button>
            <!--<div style="padding-bottom: 18px;"><input name="skip_Submit" value="Submit" type="submit"/></div>-->
            <p style="text-align: center; color: primary;" id = "msg_display"></p>
        </form>
        <div id = "htmltext"></div>

    {% endblock %}
