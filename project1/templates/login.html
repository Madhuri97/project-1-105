<!-- included similar tags as a extends from generic template -->
{% extends "generictemplate.html" %}
<!--This is for the icon display-->
{% block links %} <link rel="shortcut icon" href="{{ url_for('static', filename='icon.png') }}"> {% endblock %}
{% block title %}<title>Login Page</title>{% endblock %} 
{%  block styles %} 
<style>
    body {
        font-family: Arial;
        background-image: url('static/girlbook.gif'); background-size: cover; background-repeat: no-repeat;
        }

        * {
        box-sizing: border-box;
        }

        form.example input[type=text] {
        padding: 10px;
        font-size: 17px;
        border: 1px solid grey;
        float: left;
        width: 80%;
        background: #f1f1f1;
        }

        form.example button {
        float: left;
        width: 20%;
        padding: 10px;
        background: #2196F3;
        color: white;
        font-size: 17px;
        border: 1px solid grey;
        border-left: none;
        cursor: pointer;
        }

        form.example button:hover {
        background: #0b7dda;
        }

        .my-custom-scrollbar {
            position: relative;
            height: 400px;
            overflow: auto;
        }
        .table-wrapper-scroll-y {
        display: block;
        }
</style>
{% endblock %}
{% block scripts%}
<script type = "text/javascript"> 
// Search Form
function SearchApi( ) {
  var xhr = new XMLHttpRequest();
  var query = document.getElementById('query').value;
  xhr.open("POST", "/api/search", true);
  xhr.setRequestHeader("Content-type", "application/json");
  let json = JSON.stringify ({
    "query" : query
  });
  xhr.send(json);
  xhr.onload = () => {
    if (xhr.status == 200) {
      var data = JSON.parse(xhr.responseText);
      var htmltext = "<br><h1 id = 'display' style = 'text-align:center'>Books</h1><br><div class='container'>"+
            "<div class='table-wrapper-scroll-y my-custom-scrollbar'>"+"<table xlass = 'table' border = 1 align = 'center' class='table table-striped'>"+
            "<th class='bg-secondary text-white'> {{ 'ISBN' }}</th>"+"<th class='bg-secondary text-white'> {{ 'Title' }}</th>"+
            "<th class='bg-secondary text-white'> {{ 'Author' }}</th>"+"<th class='bg-secondary text-white'> {{ 'Year' }}</th>"+
            "<th class='bg-secondary text-white'> {{ 'View Book Page' }}</th>";
            for(var i = 0; i < data.length; i++) {
              htmltext = htmltext + "<tr>" + "<td>"+data[i]["isbn"] +"</td>"+ "<td>" + data[i]["title"] +"</td>"+
              "<td>" + data[i]["author"] +"</td>"+ "<td>" + data[i]["year"] +"</td><td><button onclick = 'bookdisplay(this)' id = "+
              data[i]["isbn"] + ">View Book</button></td></tr>"
            }
      htmltext = htmltext + " </tbody> </table> </div></div>"
      document.getElementById("htmltext").innerHTML = htmltext;
    } else if(xhr.status == 404) {
      console.log("Error: Page Not Found");
    } else {
      console.log("Error: Please Try again");
    } 
    console.log(data);
  }
}
    
</script>
{% endblock %}   
{% block body %}
        <!--Navbar which displays user email and logout button-->
        <nav class="navbar navbar-dark bg-dark justify-content-between">
        <a class="navbar-brand text-primary">&#128103&#127995: {{ user }}</a>
        <form class="form-inline">
            <button class="btn btn-outline-primary my-2 my-sm-0" type="submit" formaction = '/logout'>Logout</button>
        </form>
        </nav>
        </br>
        </br>
        </br>
        <!--This is for search area with icon search-->
        <div class="mx-auto">

            <form class="example" id = "searchapi" style="margin:auto;max-width:700px" onsubmit = "event.preventDefault(); SearchApi()">
                <input type="text" placeholder="Search.." name="Search" id = "query">
                <button type="submit" id="#display"><i class="fa fa-search"></i></button>
            </form>
        </div>
        </br>
        </br>
        <div id = "htmltext"></div>
{% endblock %}
