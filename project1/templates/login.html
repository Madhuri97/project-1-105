<!-- included similar tags as a extends from generic template -->
{% extends "generictemplate.html" %}
<!--This is for the icon display-->
{% block links %} <link rel="shortcut icon" href="{{ url_for('static', filename='icon.png') }}"> {% endblock %}
{% block title %}<title>Registration Page</title>{% endblock %} 
{%  block styles %} 
<style>
    body {
        font-family: Arial;
        background-image: url('static/girlbook.gif'); background-size: cover; background-repeat: no-repeat;
        }

        * {
        box-sizing: border-box;
        }

        form.example input[type=text] {
        padding: 10px;
        font-size: 17px;
        border: 1px solid grey;
        float: left;
        width: 80%;
        background: #f1f1f1; 
        opacity: 0.5;

        }

        form.example button {
        float: left;
        width: 20%;
        padding: 10px;
        background: #2196F3;
        color: white; 
        font-size: 17px;
        border: 1px solid grey;
        border-left: none;
        cursor: pointer;
        }

        form.example button:hover {
        background: #0b7dda;
        }

        .my-custom-scrollbar {
            position: relative;
            height: 400px;
            overflow: auto;
        }
        .table-wrapper-scroll-y {
        display: block;
        }
</style>
{% endblock %}   
{% block scripts%}
<script type = "text/javascript"> 
// Book Form
function apiBook(e) {
var isbn = e.id;
  var url = "/api/book?isbn="+isbn ;
  var xhr = new XMLHttpRequest();
  
  console.log(isbn);
  xhr.open("GET", url, true);
  xhr.setRequestHeader("Content-type", "application/json");
  let json = JSON.stringify ({
    "isbn" : isbn
  });
  xhr.send();
  xhr.onload = () => {
    if (xhr.status == 200) {
      var data = JSON.parse(xhr.responseText);
      console.log(data);
      var htmltext = "<div class='card' style = 'width:50rem;'><ul>";
      htmltext= htmltext + "<img src = 'http://covers.openlibrary.org/b/isbn/ "+ data.isbn + ".jpg ' width = '250' height = '250' alt = "+ data.title +"/> <li class ='list-group-item'><b>Isbn:</b>" + data.isbn+ "</li>" + "<li class = 'list-group-item'><b>Title:</b>"+ data.title+"</li>"+        
        "<li class = 'list-group-item'><b>Author:</b>"+data.author+"</li>"+
        "<li class = 'list-group-item'><b>Year:</b>"+ data.year+"</li>"
    
      htmltext=htmltext + "</ul></div>"
      console.log(data.reviews);
      // htmltext = htmltext + "<p id = '1416949658'>"+data.isbn +"</p><ul>";
      htmltext=htmltext+"<div><h1> Reviews</h1>"+"<tr>"
      for(var i = 0; i < data.reviews.length; i++) {
      htmltext=htmltext+"<h1 style = 'text-align:center'></h1>"+"<div class='card' style='width: 50rem; align:center'>"+
      "<ul class='list-group list-group-flush'>"+"<li class='list-group-item'><b text-primary>&#x1F464: </b>"+data.reviews[i]["email"]+"</li>"+
      "<li class='list-group-item'><b text-primary>&#11088: </b>"+data.reviews[i]["rate"]+"</li>" +"<li class='list-group-item'><b text-primary>&#x1F4AC: </b>"+data.reviews[i]["review"]+"</li>"
      }
      htmltext = htmltext + " </ul></div></tr></div>"
      
           
      document.getElementById("htmltext").innerHTML = htmltext;
    }
    else if(xhr.status == 404) {
      console.log("Error:  No Book Found");
    } else {
      console.log("Error: Please Try again");
    }
    

  }
}

</script>
{% endblock %}
{% block body %}
        <!--Navbar which displays user email and logout button-->
        <nav class="navbar navbar-dark bg-dark justify-content-between">
        <a class="navbar-brand text-primary">&#128103&#127995: {{ user }}</a>
        <form class="form-inline">
            <button class="btn btn-outline-primary my-2 my-sm-0" type="submit" formaction = '/logout'>Logout</button>
        </form>
        </nav>
        </br>
        </br>
        </br>
        <button onclick = 'apiBook(this)' id = "1416949658">View Book</button>
        <div id = "htmltext"></div>
{% endblock %}
